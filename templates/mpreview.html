{% extends 'base.html' %}

{% block title%}
üë®üèª‚Äçüíª–û—Ç—á–µ—Ç—ã –ø–æ –ú–üüë®üèª‚Äçüíª
{% endblock %}

{% block body%}




<div class="container">
    <h5 style="color: tomato;">–°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –ì–ª–µ–±–∞ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ú–ü</h5>
    <div class="row"> 
        <h5>–†–∞—Å–∫–∏–¥—ã–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –ø–æ –Ω—É–∂–Ω—ã–º –ø–∞–ø–∫–∞–º</h5>
        <hr style="color: black;">
         <div class="col-sm-12 col-md-8 col-lg-8" style="border: 2px solid; padding: 20px; border-radius: 50px;">
            <h6>–≠—Ç–æ –±–ª–æ–∫ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –æ—Ç—á–µ—Ç–æ–≤ –ú–ü –ø–æ –Ω—É–∂–Ω—ã–º –ø–∞–ø–∫–∞–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. <br> 
                –§–∞–π–ª—ã –í–ë - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ <p style="color: green;">—ç–∫—Å–µ–ª—å</p>
                –§–∞–π–ª—ã –û–ó–û–ù –∏ –Ø–ú  - <p style="color: red;">PDF</p></h6>
                <hr>
                <p>–ü–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å –æ—Ç—á–µ—Ç–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ –í–ë</p>
                <input type="date" id="dateInputWB" onchange="checkDate()">
            
            
            <form id="uploadForm">
                <p>–û—Ç—á–µ—Ç –í–ë –ü—è—Ç–∞–µ–≤</p>
                <input id="fileInput" type="file" class="fileInput" name="WBPIAT" style="color: green;" accept=".xls,.xlsx" disabled ><br>
                <input type="text" id="hraneniePI" placeholder="–°—É–º–º–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è"> <input type="text" id="reklamaPI" placeholder="–°—É–º–º–∞ –∑–∞ –†–µ–∫–ª–∞–º—É"><input type="text" id="priemkaPI" placeholder="–°—É–º–º–∞ –ø–ª–∞—Ç–Ω–æ–π –ø—Ä–∏–µ–º–∫–∏"><input type="text" id="otherPI" placeholder="–¢—Ä–∞–Ω–∑–∏—Ç"><input type="text" id="otherotherPI" placeholder="–ü–†–û–ß–ò–ï –ø—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã">
                <hr>
                <p>–û—Ç—á–µ—Ç –í–ë –ö–æ–ª–µ—Å–Ω–∏–∫–æ–≤</p>
                <input id="fileInput"  type="file" class="fileInput" name="WBKOL" style="color: green;" accept=".xls,.xlsx"disabled><br>
                <input type="text" id="hranenieKOL" placeholder="–°—É–º–º–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è"> <input type="text" id="reklamaKOL" placeholder="–°—É–º–º–∞ –∑–∞ –†–µ–∫–ª–∞–º—É"><input type="text" id="priemkaKOL" placeholder="–°—É–º–º–∞ –ø–ª–∞—Ç–Ω–æ–π –ø—Ä–∏–µ–º–∫–∏"><input type="text" id="otherKOL" placeholder="–¢—Ä–∞–Ω–∑–∏—Ç"><input type="text" id="otherotherKOL" placeholder="–ü–†–û–ß–ò–ï –ø—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã">

                <p>–û—Ç—á–µ—Ç –í–ë –ì–∏–∑–∞—Ç—É–ª–∏–Ω</p>
                <input  id="fileInput" type="file" class="fileInput" name="WBGIZ" style="color: green;" accept=".xls,.xlsx"disabled><br>
                <input type="text" id="hranenieGIZ" placeholder="–°—É–º–º–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è"> <input type="text" id="reklamaGIZ" placeholder="–°—É–º–º–∞ –∑–∞ –†–µ–∫–ª–∞–º—É"><input type="text" id="priemkaGIZ" placeholder="–°—É–º–º–∞ –ø–ª–∞—Ç–Ω–æ–π –ø—Ä–∏–µ–º–∫–∏"><input type="text" id="otherGIZ" placeholder="–¢—Ä–∞–Ω–∑–∏—Ç"><input type="text" id="otherotherGIZ" placeholder="–ü–†–û–ß–ò–ï –ø—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã">

                <p>–û—Ç—á–µ—Ç –í–ë –£–ª–∞–Ω—Å–∫–∞—è</p>
                <input  id="fileInput" type="file" class="fileInput" name="WBUL" style="color: green;" accept=".xls,.xlsx"disabled><br>
                <input type="text" id="hranenieUL" placeholder="–°—É–º–º–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è"> <input type="text" id="reklamaUL" placeholder="–°—É–º–º–∞ –∑–∞ –†–µ–∫–ª–∞–º—É"><input type="text" id="priemkaUL" placeholder="–°—É–º–º–∞ –ø–ª–∞—Ç–Ω–æ–π –ø—Ä–∏–µ–º–∫–∏"><input type="text" id="otherUL" placeholder="–¢—Ä–∞–Ω–∑–∏—Ç"><input type="text" id="otherotherUL" placeholder="–ü–†–û–ß–ò–ï –ø—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã">

                <p>–û—Ç—á–µ—Ç –í–ë –ü–µ—Ä–µ–≤–∞–ª–æ–≤</p>
                <input  id="fileInput" type="file" class="fileInput" name="WBPER" style="color: green;" accept=".xls,.xlsx"disabled><br>
                <input type="text" id="hraneniePER" placeholder="–°—É–º–º–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è"> <input type="text" id="reklamaPER" placeholder="–°—É–º–º–∞ –∑–∞ –†–µ–∫–ª–∞–º—É"><input type="text" id="priemkaPER" placeholder="–°—É–º–º–∞ –ø–ª–∞—Ç–Ω–æ–π –ø—Ä–∏–µ–º–∫–∏"><input type="text" id="otherPER" placeholder="–¢—Ä–∞–Ω–∑–∏—Ç"><input type="text" id="otherotherPER" placeholder="–ü–†–û–ß–ò–ï –ø—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã">

                <p>–û—Ç—á–µ—Ç –û–ó–û–ù –ü—è—Ç–∞–µ–≤</p>
                <p>–ü–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å –æ—Ç—á–µ—Ç–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ OZON</p>
                <input type="date" id="dateInputOZ" onchange="checkDate()">
                <input type="file" class="fileInputOZ" name="OZPIAT" style="color: green;" accept=".xls,.xlsx" disabled><br>
                <p>–û—Ç—á–µ—Ç –Ø–ù–î–ï–ö–° –ü—è—Ç–∞–µ–≤</p>
                <p>–ü–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å –æ—Ç—á–µ—Ç–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ YandexMARKET</p>
                <input type="date" id="dateInputYM" onchange="checkDate()">
                <input type="file" class="fileInputYM" name="YMPIAT" style="color: green;" accept=".xls,.xlsx" disabled><br>
                <hr>
                <input type="button" value="–û—Ç–ø—Ä–∞–≤–∏—Ç—å" onclick="uploadFiles()" class="btn-primary" style="margin: 5px;">
            </form>
            <div id="loadingSpinner" style="display: none;">
                <!-- –ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç–æ–≥–æ —Å–ø–∏–Ω–Ω–µ—Ä–∞ -->
                <div class="spinner-border" role="status">
                    <span class="sr-only">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
            </div>
         </div>
         <div class="col-sm-12 col-md-3 col-lg-3" style="border: 2px solid; border-radius: 50px; padding: 20px; margin: 5px;">
            <h6>–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å –¥–∞—Ç—ã –ø–µ—Ä–∏–æ–¥–∞ –∑–∞ –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç—á–µ—Ç –ø–æ –ú–ü –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å –ø–æ –∫–∞–∫–æ–º—É –∏–º–µ–Ω–Ω–æ –ú–ü</h6>
            
            <form>
                <input type="checkbox" id="option1" name="option1" value="WB">
                <label for="option1">WildBerris</label><br>
            
                <input type="checkbox" id="option2" name="option2" value="OZON">
                <label for="option2">OZON</label><br>
            
                <input type="checkbox" id="option3" name="option3" value="YM">
                <label for="option3">Yandex Market</label><br>
            
                <input type="checkbox" id="option4" name="option4" value="ALL">
                <label for="option4">–í—Å–µ</label><br>
            </form>
            
            <!-- –í—Ç–æ—Ä–æ–π –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç -->
            <select id="secondSelect" style="display: none;">
                <option value="cab1">CABINET 1</option>
            </select>
            <input type="text" id="whowb12" style="display: none;" value="WBPIAT">

        
            <label for="endDate">–ö–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞:</label>
            <input type="date" id="endDate" name="endDate">
            <button id="reportButton" onclick="uploadFiles2()">–∫–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞</button>
         </div>
         <div class="row">
            <div style="border: 1px solid; border-radius: 50px; padding: 20px; margin: 10px;">
                <p>–í—ã–≥—Ä—É–∑–∫–∞ –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –æ—Ç—á–µ—Ç–æ–≤ –ú–ü</p> 
                <input type="button" value="–û—Ç–ø—Ä–∞–≤–∏—Ç—å" onclick="downloadReports()" class="btn-primary" style="margin: 5px;">
            </div>
         </div>
    <div>
</div>
<script>
    function downloadReports() {
        // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ XMLHttpRequest –∏–ª–∏ fetch –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞
        fetch('/DownloadReports')
        .then(response => response.blob()) // –ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –≤ –≤–∏–¥–µ Blob
        .then(blob => {
            // –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.style.display = 'none';
            a.href = url;
            // –£–∫–∞–∑—ã–≤–∞–µ–º –∏–º—è —Ñ–∞–π–ª–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å)
            a.download = 'report.xlsx';
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            alert('–í–∞—à —Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ —Å–∫–∞—á–∞–Ω!'); // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ
        })
        .catch(error => console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ —Ñ–∞–π–ª–∞:', error));
    }
</script>
<div id="dataModal" style="display:none;">
    <div id="logika" style="display: none;">
        <p>–õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–æ–≤:</p>
        <p><h5 style="font-weight: bold;">–†–µ–∞–ª–∏–∑–∞—Ü–∏—è =</h5>"–¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞" = "–ü—Ä–æ–¥–∞–∂–∞" & "–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–ø–ª–∞—Ç—ã" != "–ß–∞—Å—Ç–∏—á–Ω–æ–µ –≤–æ–∑–º–µ—â–µ–Ω–∏–µ –ø–æ –±—Ä–∞–∫—É" + [–°—Ç–æ—Ä–Ω–æ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤] - [–°—Ç–æ—Ä–Ω–æ –ø—Ä–æ–¥–∞–∂]</p>
        <p><h5 style="font-weight: bold;">–í—ã—Ä—É—á–∫–∞ =</h5>        —Ñ–∏–ª—å—Ç—Ä1 = ("–¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞"] == "–ü—Ä–æ–¥–∞–∂–∞") & (["–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–ø–ª–∞—Ç—ã"] != "–ß–∞—Å—Ç–∏—á–Ω–æ–µ –≤–æ–∑–º–µ—â–µ–Ω–∏–µ –ø–æ –±—Ä–∞–∫—É") <br>
            —Ñ–∏–ª—å—Ç—Ä2 = (["–¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞"] == "–í–æ–∑–≤—Ä–∞—Ç") & (["–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–ø–ª–∞—Ç—ã"] != "–ß–∞—Å—Ç–∏—á–Ω–æ–µ –≤–æ–∑–º–µ—â–µ–Ω–∏–µ –ø–æ –±—Ä–∞–∫—É") <br>
            –í—ã—Ä—É—á–∫–∞ = —Ñ–∏–ª—å—Ç—Ä1 —Å—É–º–º–∞ —Å—Ç–æ–ª–±—Ü–∞ ['–í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª –¢–æ–≤–∞—Ä (–ü—Ä)'] - —Ñ–∏–ª—å—Ç—Ä2 —Å—É–º–º–∞ —Å—Ç–æ–ª–±—Ü–∞ ['–í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª –¢–æ–≤–∞—Ä (–ü—Ä)']
    </p>
        <p><h5 style="font-weight: bold;">–ö–æ–º–∏—Å—Å–∏—è =</h5>—Ñ–∏–ª—å—Ç—Ä 1 = (["–¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞"] == "–ü—Ä–æ–¥–∞–∂–∞") & (["–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–ø–ª–∞—Ç—ã"] != "–ß–∞—Å—Ç–∏—á–Ω–æ–µ –≤–æ–∑–º–µ—â–µ–Ω–∏–µ –ø–æ –±—Ä–∞–∫—É") <br>
            —Ñ–∏–ª—å—Ç—Ä2 = (["–¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞"] == "–í–æ–∑–≤—Ä–∞—Ç") & (["–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–ø–ª–∞—Ç—ã"] != "–ß–∞—Å—Ç–∏—á–Ω–æ–µ –≤–æ–∑–º–µ—â–µ–Ω–∏–µ –ø–æ –±—Ä–∞–∫—É") <br>
            –ö–æ–º–∏—Å—Å–∏—è = —Ñ–∏–ª—å—Ç—Ä1 —Å—É–º–º–∞ ['–ö–æ–º–∏—Å—Å–∏—è']* - —Ñ–∏–ª—å—Ç—Ä2 —Å—É–º–º–∞ —Å—Ç–æ–ª–±—Ü–∞ ['–ö–æ–º–∏—Å—Å–∏—è'] + —Å—É–º–º–∞ —Å—Ç–æ–ª–±—Ü–∞ ['–í–æ–∑–º–µ—â–µ–Ω–∏–µ –∏–∑–¥–µ—Ä–∂–µ–∫ –ø–æ –ø–µ—Ä–µ–≤–æ–∑–∫–µ']</p>
            *–ö–æ–º–∏—Å—Å–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–æ—Å—Ç–æ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É ['–í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª –¢–æ–≤–∞—Ä (–ü—Ä)'] - ['–ö –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—é –ü—Ä–æ–¥–∞–≤—Ü—É –∑–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –¢–æ–≤–∞—Ä']
        <p><h5 style="font-weight: bold;">–õ–æ–≥–∏—Å—Ç–∏–∫–∞ =</h5> —Å—É–º–º–∞ —Å—Ç–æ–ª–±—Ü–∞ ['–£—Å–ª—É–≥–∏ –ø–æ –¥–æ—Å—Ç–∞–≤–∫–µ —Ç–æ–≤–∞—Ä–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—é'] –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ –°—Ç—Ä–∞–Ω–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–∞—è –∏–ª–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è</p>
        <p><h5 style="font-weight: bold;">–û—Å—Ç–∞–ª—å–Ω–æ–µ =</h5> –¢–æ —á—Ç–æ –±—ã–ª–æ –≤–Ω–µ—Å–µ–Ω–æ —Ä—É–∫–∞–º–∏ - –¥–µ–ª–∏—Ç—å—Å—è –Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∏ —Ä–∞–∑–Ω–æ—Å–∏—Ç—Å—è –≤ –≤ —Ä–∞–≤–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö –Ω–∞ –ø—Ä–æ–¥–∞–∂–∏</p>
        <button onclick="closeLogika()">–°–∫—Ä—ã—Ç—å –ª–æ–≥–∏–∫—É –º–∞–≥–∏–∏</button>
    </div>
    <br>
    <button onclick="openLogika()" style="display: block;" id="ghg">–ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏–∫—É –º–∞–≥–∏–∏</button>
    <br>
    <div id="dataContainer"></div>
    <button onclick="closeModal()" class="btn btn-outline-primary">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var selectElement = document.getElementById('secondSelect');
        var inputElement = document.getElementById('whowb12');

        selectElement.addEventListener('change', function () {
            inputElement.value = selectElement.value;
        });
    });
</script>
<script>
    function openLogika() {
        document.getElementById('ghg').style.display = 'none';
        document.getElementById('logika').style.display = 'block';
    }
    function closeLogika() {
        document.getElementById('ghg').style.display = 'block';
        document.getElementById('logika').style.display = 'none';
    }

    document.getElementById('option1').addEventListener('change', function() {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Ç–æ—Ä–æ–π —Å–ø–∏—Å–æ–∫, –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ –û–ø—Ü–∏—è 1
        if (this.value === 'WB') {
            document.getElementById('secondSelect').style.display = 'block';
        } else {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Ç–æ—Ä–æ–π —Å–ø–∏—Å–æ–∫ –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö
            document.getElementById('secondSelect').style.display = 'none';
        }
    });


    
</script>

<script>
    document.getElementById('option4').addEventListener('change', function() {
        if (this.checked) {
            document.getElementById('option1').checked = false;
            document.getElementById('option2').checked = false;
            document.getElementById('option3').checked = false;
            document.getElementById('secondSelect').style.display = 'none';
        }
    });

    function uncheckOption4() {
        document.getElementById('option4').checked = false;
    }

    document.getElementById('option1').addEventListener('change', uncheckOption4);
    document.getElementById('option2').addEventListener('change', uncheckOption4);
    document.getElementById('option3').addEventListener('change', uncheckOption4);
</script>



<script>
    document.getElementById('startDate').addEventListener('change', function() {
        var startDate = new Date(this.value);
        var endDate = new Date(document.getElementById('endDate').value);

        if (startDate > endDate) {
            document.getElementById('endDate').value = this.value;
        }
    });

    document.getElementById('endDate').addEventListener('change', function() {
        var endDate = new Date(this.value);
        var startDate = new Date(document.getElementById('startDate').value);

        if (startDate > endDate) {
            document.getElementById('startDate').value = this.value;
        }
    });
</script>
    


<script>
    
    function uploadFiles() {
        var form = document.getElementById('uploadForm');
        var loadingSpinner = document.getElementById('loadingSpinner');
        var fileInputs = form.querySelectorAll('input[type="file"]');
        var filesData = {};
        var rashpdyPI = {hranenie : document.getElementById('hraneniePI').value,
         reklama :document.getElementById('reklamaPI').value,
        priemka : document.getElementById('priemkaPI').value,
        other : document.getElementById('otherPI').value};
        
        loadingSpinner.style.display = 'block';
        console.log(rashpdyPI)
        Promise.all(Array.from(fileInputs).map(input => {
            if(input.files[0]) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        filesData[input.name] = e.target.result; // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫–∏ Base64
                        resolve();
                    };
                    reader.onerror = reject;
                    reader.readAsDataURL(input.files[0]);
                });
            }
        })).then(() => {
            otherotherPI
            // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            fetch('/upload?dataWB='+document.getElementById('dateInputWB').value+'&izderPI='+document.getElementById('hraneniePI').value, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(filesData)
            })
            .then(response => response.text())
            .then(html => {
                document.getElementById('dataContainer').innerHTML = html;
                document.getElementById('dataModal').style.display = 'block';
                Array.from(fileInputs).forEach(input => input.value = "");
                loadingSpinner.style.display = 'none';
            })
            .catch((error) => {
                console.error('–û—à–∏–±–∫–∞:', error);
                alert('–û—à–∏–±–∫–∞ - –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ');
                loadingSpinner.style.display = 'none';
            });
        });
    }
    function closeModal() {
        document.getElementById('dataModal').style.display = 'none';
    }
</script>

<script>
    document.getElementById('fileInput').addEventListener('change', function(e) {
        var file = e.target.files[0];
        var fileName = file.name;

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
        if (fileName.endsWith('.xls') || fileName.endsWith('.xlsx')) {
            
            // –ó–¥–µ—Å—å –≤–∞—à –∫–æ–¥ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–æ–º Excel
        } else {
            alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel');
            // –û—á–∏—â–∞–µ–º –∏–Ω–ø—É—Ç, –µ—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ Excel
            e.target.value = '';
        }
    });
</script>


<script>
    $(document).ready(function(){
        $('#dateInputWB').on('input', function() {
            // –í—ã–±–∏—Ä–∞–µ–º –≤—Å–µ –∏–Ω–ø—É—Ç—ã —Å –∫–ª–∞—Å—Å–æ–º 'fileInput' –∏ –º–µ–Ω—è–µ–º –∏—Ö —Å–≤–æ–π—Å—Ç–≤–æ 'disabled'
            $('.fileInput').prop('disabled', false);
        });
    });
</script>

<script>
    $(document).ready(function(){
        $('#dateInputOZ').on('input', function() {
            // –í—ã–±–∏—Ä–∞–µ–º –≤—Å–µ –∏–Ω–ø—É—Ç—ã —Å –∫–ª–∞—Å—Å–æ–º 'fileInput' –∏ –º–µ–Ω—è–µ–º –∏—Ö —Å–≤–æ–π—Å—Ç–≤–æ 'disabled'
            $('.fileInputOZ').prop('disabled', false);
        });
    });
</script>
<script>
    $(document).ready(function(){
        $('#dateInputYM').on('input', function() {
            // –í—ã–±–∏—Ä–∞–µ–º –≤—Å–µ –∏–Ω–ø—É—Ç—ã —Å –∫–ª–∞—Å—Å–æ–º 'fileInput' –∏ –º–µ–Ω—è–µ–º –∏—Ö —Å–≤–æ–π—Å—Ç–≤–æ 'disabled'
            $('.fileInputYM').prop('disabled', false);
        });
    });
</script>

<script>
    var WBB = document.getElementById('option1').value
    var OZZ = document.getElementById('option2').value
    var YMM = document.getElementById('option3').value
    var ALL = document.getElementById('option4').value
    var WBwho = document.getElementById('whowb12').value
function uploadFiles2() {
        fetch('/reports'+'?dataEnd='+document.getElementById('endDate').value
        +'&WHO='+WBB+';'+OZZ+';'+YMM+';'+ALL+'&WB='+WBwho, {
            method: 'POST',
        })
        .then(console.log(WBwho))
        .then(response => response.text())
        .then(data => {
            console.log('–£—Å–ø–µ—Ö:', data);
        })
        .catch((error) => {
            console.error('–û—à–∏–±–∫–∞:', error);
        });
    };
</script>


<style>

    /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ */
    #dataModal {
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        width: 80%; /* –®–∏—Ä–∏–Ω–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ */
        height: 66%; /* 2/3 –≤—ã—Å–æ—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
        background-color: white;
        padding: 20px;
        border: 1px solid #ddd;
        z-index: 1000;
        overflow-y: auto; /* –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* –¢–µ–Ω—å –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ */
        display: none; /* –û–∫–Ω–æ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–æ */
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ */
    #dataContainer {
        max-height: 100%; /* –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤—ã—Å–æ—Ç–µ */
        overflow-y: auto; /* –ü—Ä–æ–∫—Ä—É—Ç–∫–∞, –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–Ω—Ç –±–æ–ª—å—à–µ –≤—ã—Å–æ—Ç—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
    }


    /* –í–∞—à–∏ —Ç–µ–∫—É—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã */
    .myTable {
        border-collapse: collapse;
        width: 100%;
    }
    .myTable, .myTable th, .myTable td {
        border: 2px solid black;
    }
    .myTable th, .myTable td {
        padding: 5px;
        text-align: left;
    }
</style>
<script>
    document.getElementById('workpage').style.borderBottom = '2px solid'
    document.getElementById('workpage').style.borderColor = 'violet'
  </script>

{% endblock %}